% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_fft.R
\name{fit_fft}
\alias{fit_fft}
\title{Fit amplitude and phase using FFT spectral extraction}
\usage{
fit_fft(
  empiricalData,
  boundaryMean,
  periodInSeconds,
  optimizeRange,
  nmin,
  empiricalDataPeriods
)
}
\arguments{
\item{empiricalData}{A zoo object with one column per sensor depth.}

\item{boundaryMean}{Numeric -- not used by FFT but retained for interface
compatibility.}

\item{periodInSeconds}{Numeric -- period of the target cycle (s).}

\item{optimizeRange}{Numeric length-2 -- phase window for unwrapping.}

\item{nmin}{Integer -- minimum non-NA observations to attempt fitting.}

\item{empiricalDataPeriods}{Numeric -- number of complete cycles.}
}
\value{
Same structure as fit_ols/fitCosine: list(deltaPhaseRadians,
  ampRatio) with attributes "amplitudes" and "phases".
}
\description{
Extracts amplitude and phase at the nearest Fourier frequency bin to the
target period. A single FFT gives amplitude and phase at every resolvable
frequency simultaneously; this function extracts the bin closest to the
specified period.
}
\details{
**Phase convention:** To match fit_ols, phase is computed as -Arg(X[k])
where X[k] is the complex DFT coefficient at the target bin. This gives
phase in the same convention as atan2(alpha_s, alpha_c) from the OLS
linearized cosine model, ensuring pairwise deltaPhaseRadians are
consistent across methods.

**Bin matching:** The target period (e.g., 86400s for diel) may not land
exactly on a Fourier frequency bin. The function selects the nearest bin.
Accuracy improves with longer records (finer frequency resolution).
A warning is issued if the nearest bin period differs from the target
by more than 1%.

**When to prefer FFT over OLS:**
- When you want to survey multiple frequencies from the same data
- When the signal contains harmonics (non-sinusoidal shape) and you
  want amplitude/phase at each harmonic independently
- As a cross-check against OLS results

**When to prefer OLS:**
- When the target frequency does not land near a Fourier bin
- For short records where frequency resolution is coarse
- When you need to include polynomial trend terms in the regression
}
\references{
Luce, C. H., Tonina, D., Gariglio, F., & Applebee, R. (2013). WRR 49.
Vogt, T., Schirmer, M., & Cirpka, O. A. (2012). HESS 16.
}
