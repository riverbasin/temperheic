% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/signal_processing.R
\name{window_temperature}
\alias{window_temperature}
\title{Slice a temperature time series into overlapping analysis windows}
\usage{
window_temperature(x, width, step = width, min_coverage = 0.9)
}
\arguments{
\item{x}{A zoo object. Single-column or multi-column.}

\item{width}{Numeric: window width in seconds. For diel analysis,
7 * 86400 (7 days) is a good starting point.}

\item{step}{Numeric: step size in seconds between successive window
starts. Controls overlap. `step = width` gives non-overlapping
windows; `step < width` gives overlap; `step = 86400` slides by
one day. Default is `width` (non-overlapping).}

\item{min_coverage}{Numeric in (0, 1]: minimum fraction of expected
observations (non-NA) required within a window to retain it. Default 0.9.
Expected observation count is computed from the window width and the
median sampling interval of the full record. This catches both NA
values at existing timestamps and temporal gaps where index entries
are missing entirely. Windows failing the check are dropped with
a message.}
}
\value{
A tibble with columns:
  \describe{
    \item{window_start}{Numeric: start time of window (seconds, matching zoo index).}
    \item{window_end}{Numeric: end time of window (seconds).}
    \item{window_center}{Numeric: midpoint of window (seconds).}
    \item{data}{List-column of zoo objects, one per window. Each zoo
      retains the column structure of the input.}
  }
}
\description{
Divides a zoo object into temporal windows for time-varying analysis.
Each window becomes an independent input for amplitude/phase extraction
and flux estimation, producing a time series of parameter estimates
rather than a single whole-record average.
}
\details{
Windows are defined by width and step, both in seconds (matching the
zoo index units and the physical constants in the ADE solution).
Common values:

\itemize{
  \item Diel analysis: `width = 7 * 86400` (7 days), `step = 86400` (1 day)
  \item Seasonal analysis: `width = 90 * 86400` (90 days), `step = 30 * 86400` (30 days)
}

The \pkg{lubridate} package provides a readable bridge:
`as.numeric(lubridate::as.duration(lubridate::days(7)), "seconds")` returns
604800 (= 7 * 86400). Internalizing these conversions builds intuition
for the connection between the time axis, angular frequency (omega =
2*pi/period), and the physical process.

Key periods in seconds:
\itemize{
  \item 1 hour = 3600
  \item 1 day (diel period) = 86400
  \item 1 week = 604800
  \item 1 year (annual period) = 31557600 (365.25 * 86400)
}

Windows that extend beyond the data are silently dropped. A warning
is issued if fewer than 2 complete windows are produced.

For multi-column zoo objects, the entire object is windowed together
(all sensors share the same time axis), preserving the column structure
needed by `thObservedSeries()`.
}
\examples{
\dontrun{
# 7-day sliding windows with 1-day step for diel analysis
windows <- stream_temp \%>\%
  window_temperature(width = 7 * 86400, step = 86400)

# Pipe into analysis with purrr
results <- windows \%>\%
  dplyr::mutate(
    detrended = purrr::map(data, detrend_temperature),
    flux = purrr::map(detrended, ~estimate_flux(.x, ...))
  )
}

}
