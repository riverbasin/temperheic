% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/thSeries.R
\name{thObservedSeries}
\alias{thObservedSeries}
\title{Recover thermal parameters from observed temperature data (inverse model)}
\usage{
thObservedSeries(
  empiricalData,
  xVals,
  aquifer,
  boundaryMean,
  period,
  headGrad,
  nmin,
  freq = (2 * pi)/period,
  optimizeRange = c(-1/8, 7/8),
  specificUnits = thUnits(),
  empiricalDataPeriods = rep(1, ncol(empiricalData)),
  fit_method = c("ols", "nls", "fft")
)
}
\arguments{
\item{empiricalData}{A zoo object with one column per sensor depth.}

\item{xVals}{Named numeric vector of sensor depths (m). Must include 0.
Names must match column names of empiricalData.}

\item{aquifer}{A thAquifer object with thermal/physical properties.}

\item{boundaryMean}{Numeric - mean temperature at the boundary (degC).}

\item{period}{Numeric - period of the target cycle (s). 86400 for diel.}

\item{headGrad}{Numeric - hydraulic head gradient (dimensionless).}

\item{nmin}{Integer - minimum non-NA observations to attempt fitting.}

\item{freq}{Numeric - angular frequency (rad/s). Default 2*pi/period.}

\item{optimizeRange}{Numeric length-2 - phase window as fractions of period.}

\item{specificUnits}{A thUnits object. Must match the aquifer units.}

\item{empiricalDataPeriods}{Numeric vector - number of complete cycles per
sensor. Default rep(1, ncol(empiricalData)).}

\item{fit_method}{Character -- method for amplitude/phase extraction.
"ols" (default) uses linearized OLS harmonic regression (Luce et al. 2013).
"nls" uses the legacy nonlinear least squares cosine fit (fitCosine).
"fft" uses FFT spectral extraction at the nearest Fourier bin.}
}
\value{
A temperheic S3 object (class thObservedSeries/thSeries/temperheic)
}
\description{
Fits cosine curves to multi-depth temperature time series and uses the
amplitude ratios and phase differences to estimate thermal velocity,
diffusivity, and Darcy flux via the eta-parameter method (Luce et al. 2013).
}
\details{
The estimation pipeline:
1. fit_ols() or fitCosine() extracts amplitude and phase at each sensor depth
2. Pairwise amplitude ratios and phase differences are computed
3. eta = -ln(Ar) / delta_phi  (Luce 2013)
4. Thermal velocity from eta and phase diff (Luce et al. 2013, thermal velocity from eta)
5. Effective diffusivity from eta and amplitude ratio (Luce et al. 2013, diffusivity from eta)
6. Darcy flux, water velocity, dispersivity, hydraulic conductivity derived
}
\references{
Luce, C. H., Tonina, D., Gariglio, F., & Applebee, R. (2013). Solutions for
the diurnally forced advection-diffusion equation to estimate bulk fluid
velocity and diffusivity in streambeds from temperature time series. Water
Resources Research, 49, 488-506. doi:10.1002/wrcr.20090

Luce, C. H., & Tonina, D. (2017). Scaling thermal transport from streams
and their beds. Water Resources Research, 53, 9771-9790.
doi:10.1002/2017WR021472
}
